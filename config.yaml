data:
  random_seed: 42
  input_files: "/ceph/cms/store/user/aaarora/tracking/*.root"
  data_dir: "/ceph/cms/store/user/aaarora/tracking/data"
  train_split: 0.6
  val_split: 0.2
  test_split: 0.2

model:
  input_dim: 49
  hidden_dims: [256, 128, 64, 32]
  residual_dim: 32
  dropout: 0.1
  n_res_blocks: 3

trainer:
  accelerator: auto
  devices: 1
  log_every_n_steps: 1
  deterministic: true
  gradient_clip_val: 1.0
  accumulate_grad_batches: 1  

training:
  loss_fn: FocalLoss
  learning_rate: 0.0001
  batch_size: 131072
  max_epochs: 20
  num_workers: 8

  scheduler:
    milestones: [5, 10, 15]
    gamma: 0.5
    monitor: val_loss
    interval: epoch
    frequency: 1

callbacks:
  checkpoint:
    save_top_k: 3
    monitor: train_loss
    mode: min
    every_n_train_steps: 10
  
  early_stopping:
    monitor: train_loss
    patience: 10
    mode: min

logger:
  save_dir: output/

analysis:
  target_recall: 0.999
  correlation_top_n: 10
  robustness_noise_levels: [0.01, 0.05, 0.1]
  robustness_n_samples: 5000
  robustness_batch_size: 32768
  shap_batch_size: 32768
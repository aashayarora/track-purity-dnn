model:
  input_dim: 49
  hidden_dims: [256, 128, 64, 32]
  residual_dim: 32
  dropout: 0.1
  n_res_blocks: 3

trainer:
  accelerator: auto
  devices: 2
  log_every_n_steps: 1
  deterministic: true
  gradient_clip_val: 1.0
  accumulate_grad_batches: 4

training:
  loss_fn: FocalLoss
  learning_rate: 0.0001
  batch_size: 131072
  max_epochs: 100
  num_workers: 16
  
scheduler:
  milestones: [30, 60, 90]
  gamma: 0.5
  monitor: val_loss
  interval: epoch
  frequency: 1

callbacks:
  checkpoint:
    save_top_k: 3
    monitor: train_loss
    mode: min
    every_n_train_steps: 10
  
  early_stopping:
    monitor: train_loss
    patience: 10
    mode: min

logger:
  save_dir: output/

data:
  random_seed: 42
  lazy_load: false
  input_files: "/ceph/cms/store/user/aaarora/tracking/output_TT_*.root"
  n_workers: 16 
  train_split: 0.6
  val_split: 0.2
  test_split: 0.2
  batch_size: 100